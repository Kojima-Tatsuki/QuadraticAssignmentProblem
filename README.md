# 二次割り当て問題(QAP)

## 例
以下のような配置の場合の例を示す.  
順列 $q = \\{ 2, 1, 4, 3 \\}$ のように表現される.

| 施設 | 場所 |
| :--: | :--: |
| 2 | 1 |
| 1 | 2 |
| 4 | 3 |
| 3 | 4 |

施設間
| 施設 i | 施設 j | フロー(i, j) |
| :-- | :-- | :-- |
| 1 | 2 | 3 |
| 1 | 4 | 2 |
| 2 | 4 | 1 |
| 3 | 4 | 3 |

場所間
| 場所 i | 場所 j | 距離(i, j) |
| :-- | :-- | :-- |
| 1 | 3 | 53 |
| 2 | 1 | 22 |
| 2 | 3 | 40 |
| 3 | 4 | 55 |

上のような表で計算を行う場合、スコアは以下の式で得られる 
```math
\begin{align}
  &f(1,2)d(2,1)+f(1,4)d(2,3)+f(2,4)d(1,3)+f(3,4)d(3,4) \\
  &= 3*22 + 2*40 + 1*53 + 4*55 \\
  &= 419
\end{align}
```
![qap_fig](https://neos-guide.org/wp-content/uploads/2022/05/qap.png)

## 例2

Distance Matrix
|   |A   |B  |C   |D|
|:--:|:--|:--|:--|:--|
|A  |0   |22 |53	|53|
|B  |22  |0  |40	|62|
|C  |53  |40 |0	  |55|
|D  |53  |62 |55	|0|

Flows
|   |1	|2	|3	|4|
|:--:|:--|:--|:--|:--|
|1	|0	|3	|0	|2|
|2	|3	|0	|0	|1|
|3	|0	|0	|0	|4|
|4	|2	|1	|4	|0|

### 最適解
$q = \\{3, 4, 1, 2\\}$, $score = 395$  
$f(3,4)d(1,2) + $

# 参考文献
1. Quadratic Assignment Problem, https://neos-guide.org/case-studies/sc/la/qap/
